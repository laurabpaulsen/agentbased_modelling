PrS <- inv_logit(post_int$I)
diff_prob <- sapply(1:6, function(i) PrS[, 1, i] - PrS[, 2, i] )
colorlist = c('steelblue1', 'palegreen3', 'khaki', 'blue')
plot(NULL, xlim = c(-1,1), ylim = c(0, 10), main = 'Intervention Contrast (Probability)',ylab = 'Density', xlab = 'Intervention Contrast (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Intervention 1", "2", "3", "4"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 1] - PrS[, 1, 1] )
colorlist = c('steelblue1', 'palegreen3', 'khaki', 'blue')
plot(NULL, xlim = c(-1,1), ylim = c(0, 10), main = 'Intervention Contrast (Probability)',ylab = 'Density', xlab = 'Intervention Contrast (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Intervention 1", "2", "3", "4"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 1] - PrS[, 1, 1] )
colorlist = c('steelblue1', 'palegreen3', 'khaki', 'blue')
plot(NULL, xlim = c(-1,1), ylim = c(0, 10), main = 'Intervention Contrast (Probability)',ylab = 'Density', xlab = 'Intervention Contrast (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("2", "3", "4"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 1] - PrS[, 1, 1] )
colorlist = c('steelblue1', 'palegreen3', 'khaki', 'blue')
plot(NULL, xlim = c(-0.5,0.5), ylim = c(0, 5), main = 'Intervention Contrast (Probability)',ylab = 'Density', xlab = 'Intervention Contrast (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("2", "3", "4"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 2] - PrS[, 1, 2] )
colorlist = c('steelblue1', 'palegreen3', 'khaki', 'blue')
plot(NULL, xlim = c(-0.5,0.5), ylim = c(0, 5), main = 'Intervention Contrast (Probability)',ylab = 'Density', xlab = 'Intervention Contrast (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("2", "3", "4"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 1] - PrS[, 1, 1] )
colorlist = c('steelblue1', 'palegreen3', 'khaki', 'blue')
plot(NULL, xlim = c(-0.5,0.5), ylim = c(0, 5), main = 'Intervention Contrast (Probability)',ylab = 'Density', xlab = 'Intervention Contrast (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("2", "3", "4"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 1] - PrS[, 1, 1] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plot(NULL, xlim = c(-0.5,0.5), ylim = c(0, 5), main = 'Intervention Contrast (Probability)',ylab = 'Density', xlab = 'Intervention Contrast (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Shared Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 6] - PrS[, 1, 6] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plot(NULL, xlim = c(-0.5,0.5), ylim = c(0, 5), main = 'Intervention Contrast - Level 6 ',ylab = 'Density', xlab = 'Intervention Contrast at level 6')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Shared Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 6] - PrS[, 1, 6] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plot(NULL, xlim = c(-0.2,0.2), ylim = c(0, 5), main = 'Intervention Contrast - Level 6 ',ylab = 'Density', xlab = 'Intervention Contrast at level 6')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Shared Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 6] - PrS[, 1, 6] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plot(NULL, xlim = c(-0.2,0.2), ylim = c(0, 10), main = 'Intervention Contrast - Level 6 ',ylab = 'Density', xlab = 'Intervention Contrast at level 6')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Shared Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 6] - PrS[, 1, 6] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plot(NULL, xlim = c(-0.2,0.2), ylim = c(0, 10), main = 'Intervention Contrast - Level 6 ',ylab = 'Density', xlab = 'Intervention Contrast at level 6')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 6] - PrS[, 1, 6] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plot(NULL, xlim = c(-0.2,0.2), ylim = c(0, 20), main = 'Intervention Contrast - Level 6 ',ylab = 'Density', xlab = 'Intervention Contrast at level 6')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 6] - PrS[, 1, 6] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plot(NULL, xlim = c(-0.2,0.2), ylim = c(0, 100), main = 'Intervention Contrast - Level 6 ',ylab = 'Density', xlab = 'Intervention Contrast at level 6')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 6] - PrS[, 1, 6] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plot(NULL, xlim = c(-0.2,0.2), ylim = c(0, 40), main = 'Intervention Contrast - Level 6 ',ylab = 'Density', xlab = 'Intervention Contrast at level 6')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 6] - PrS[, 1, 6] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plot(NULL, xlim = c(-0.1,0.15), ylim = c(0, 40), main = 'Intervention Contrast - Level 6 ',ylab = 'Density', xlab = 'Intervention Contrast at level 6')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 6] - PrS[, 1, 6] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plot(NULL, xlim = c(-0.1,0.15), ylim = c(0, 40), main = 'Intervention Contrast - Level 6 ',ylab = 'Density', xlab = 'Contrast (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 6] - PrS[, 1, 6] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plot(NULL, xlim = c(-0.1,0.15), ylim = c(0, 40), main = 'Intervention Contrast - Level 6 (Entry-level)',ylab = 'Density', xlab = 'Contrast (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 6] - PrS[, 1, 6] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plot(NULL, xlim = c(-0.1,0.15), ylim = c(0, 40), main = 'Intervention Contrast - Level 6 (Entry-level)',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 5] - PrS[, 1, 5] )
)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 5] - PrS[, 1, 5] )
plot(NULL, xlim = c(-0.1,0.15), ylim = c(0, 40), main = 'Intervention Contrast - Level 5',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 5] - PrS[, 1, 5] )
plot(NULL, xlim = c(-0.1,0.1), ylim = c(0, 40), main = 'Intervention Contrast - Level 5',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 4] - PrS[, 1, 4] )
plot(NULL, xlim = c(-0.1,0.1), ylim = c(0, 40), main = 'Intervention Contrast - Level 4',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 4] - PrS[, 1, 4] )
plot(NULL, xlim = c(-0.15,0.1), ylim = c(0, 40), main = 'Intervention Contrast - Level 4',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 4] - PrS[, 1, 4] )
plot(NULL, xlim = c(-0.15,0.15), ylim = c(0, 40), main = 'Intervention Contrast - Level 4',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 4] - PrS[, 1, 4] )
plot(NULL, xlim = c(-0.15,0.15), ylim = c(0, 40), main = 'Intervention Contrast - Level 4',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
```{r}
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 3] - PrS[, 1, 3] )
plot(NULL, xlim = c(-0.1,0.1), ylim = c(0, 40), main = 'Intervention Contrast - Level 3',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 3] - PrS[, 1, 3] )
plot(NULL, xlim = c(-0.1,0.1), ylim = c(0, 20), main = 'Intervention Contrast - Level 3',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 3] - PrS[, 1, 3] )
plot(NULL, xlim = c(-0.3,0.3), ylim = c(0, 20), main = 'Intervention Contrast - Level 3',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 3] - PrS[, 1, 3] )
plot(NULL, xlim = c(-0.2,0.2), ylim = c(0, 20), main = 'Intervention Contrast - Level 3',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 2] - PrS[, 1, 2] )
plot(NULL, xlim = c(-0.2,0.2), ylim = c(0, 20), main = 'Intervention Contrast - Level 2',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 2] - PrS[, 1, 2] )
plot(NULL, xlim = c(-0.5,0.5), ylim = c(0, 20), main = 'Intervention Contrast - Level 2',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 2] - PrS[, 1, 2] )
plot(NULL, xlim = c(-0.4,0.4), ylim = c(0, 20), main = 'Intervention Contrast - Level 2',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 2] - PrS[, 1, 2] )
plot(NULL, xlim = c(-0.3,0.3), ylim = c(0, 20), main = 'Intervention Contrast - Level 2',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 1] - PrS[, 1, 1] )
plot(NULL, xlim = c(-0.2,0.2), ylim = c(0, 20), main = 'Intervention Contrast - Level 1',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 1] - PrS[, 1, 1] )
plot(NULL, xlim = c(-0.2,0.2), ylim = c(0, 5), main = 'Intervention Contrast - Level 1',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
post_int <- extract.samples(m)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, 1] - PrS[, 1, 1] )
plot(NULL, xlim = c(-0.5,0.5), ylim = c(0, 5), main = 'Intervention Contrast - Level 1',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
prior <- extract.prior(m)
predictions <- link(m, post = prior, data = dat)
priormeans <- rowMeans(predictions)
dens(inv_logit(priormeans), main="Means of Prior Predictions Across All Passengers")
dens(priormeans, main="Means of Prior Predictions Across All Passengers")
dens(priormeans, main="Means of Prior Predictions Across All Agents")
'hej' + '2'
level <- 1
paste('Intervention Contrast', level)
plot_contrasts <- function(level){
title <-paste('Intervention Contrast - Level', level)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, level] - PrS[, 1, level] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plot(NULL, xlim = c(-0.1,0.15), ylim = c(0, 40), main = 'Intervention Contrast - Level 6 (Entry-level)',ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
}
plot_contrasts(5)
plot_contrasts <- function(level){
title <-paste('Intervention Contrast - Level', level)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, level] - PrS[, 1, level] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plot(NULL, xlim = c(-0.1,0.15), ylim = c(0, 40), main = title,ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
}
plot_contrasts(5)
post_int <- extract.samples(m)
plot_contrasts(6)
plot_contrasts(5)
plot_contrasts(4)
plot_contrasts(3)
plot_contrasts(2)
plot_contrasts(1)
plot_contrasts <- function(level, xlim, ylim){
title <-paste('Intervention Contrast - Level', level)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, level] - PrS[, 1, level] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plot(NULL, xlim = xlim, ylim = ylim, main = title,ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
}
plot_contrasts(6, xlim = c(-0.05, 0.15))
plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 20))
plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 40))
post_int <- extract.samples(m)
plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 40))
plot_contrasts(5, xlim = c(-0.05, 0.15), ylim = c(0, 40))
plot_contrasts(4, xlim = c(-0.05, 0.15), ylim = c(0, 40))
plot_contrasts(3, xlim = c(-0.05, 0.15), ylim = c(0, 40))
plot_contrasts(2, xlim = c(-0.05, 0.15), ylim = c(0, 40))
plot_contrasts(1, xlim = c(-0.05, 0.15), ylim = c(0, 40))
post_int <- extract.samples(m)
plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 40))
plot_contrasts(5, xlim = c(-0.05, 0.15), ylim = c(0, 30))
plot_contrasts(4, xlim = c(-0.05, 0.15), ylim = c(0, 20))
plot_contrasts(3, xlim = c(-0.05, 0.15), ylim = c(0, 15))
plot_contrasts(2, xlim = c(-0.05, 0.15), ylim = c(0, 10))
plot_contrasts(1, xlim = c(-0.05, 0.15), ylim = c(0, 5))
post_int <- extract.samples(m)
plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 40))
plot_contrasts(5, xlim = c(-0.05, 0.15), ylim = c(0, 30))
plot_contrasts(4, xlim = c(-0.05, 0.15), ylim = c(0, 20))
plot_contrasts(3, xlim = c(-0.05, 0.15), ylim = c(0, 15))
plot_contrasts(2, xlim = c(-0.05, 0.15), ylim = c(0, 10))
plot_contrasts(1, xlim = c(-2,2), ylim = c(0, 5))
post_int <- extract.samples(m)
plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 40))
plot_contrasts(5, xlim = c(-0.05, 0.15), ylim = c(0, 30))
plot_contrasts(4, xlim = c(-0.05, 0.15), ylim = c(0, 20))
plot_contrasts(3, xlim = c(-0.05, 0.15), ylim = c(0, 15))
plot_contrasts(2, xlim = c(-0.05, 0.15), ylim = c(0, 10))
plot_contrasts(1, xlim = c(-1,1), ylim = c(0, 5))
post_int <- extract.samples(m)
plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 40))
plot_contrasts(5, xlim = c(-0.05, 0.15), ylim = c(0, 30))
plot_contrasts(4, xlim = c(-0.05, 0.15), ylim = c(0, 20))
plot_contrasts(3, xlim = c(-0.05, 0.15), ylim = c(0, 15))
plot_contrasts(2, xlim = c(-0.05, 0.15), ylim = c(0, 10))
plot_contrasts(1, xlim = c(-0.5,0.5), ylim = c(0, 5))
post_int <- extract.samples(m)
plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 40))
plot_contrasts(5, xlim = c(-0.05, 0.15), ylim = c(0, 30))
plot_contrasts(4, xlim = c(-0.05, 0.15), ylim = c(0, 20))
plot_contrasts(3, xlim = c(-0.05, 0.15), ylim = c(0, 15))
plot_contrasts(2, xlim = c(-0.5, 0.5), ylim = c(0, 10))
plot_contrasts(1, xlim = c(-0.5,0.5), ylim = c(0, 5))
post_int <- extract.samples(m)
plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 40))
plot_contrasts(5, xlim = c(-0.05, 0.15), ylim = c(0, 30))
plot_contrasts(4, xlim = c(-0.05, 0.15), ylim = c(0, 20))
plot_contrasts(3, xlim = c(-0.05, 0.15), ylim = c(0, 15))
plot_contrasts(2, xlim = c(-0.4, 0.4), ylim = c(0, 10))
plot_contrasts(1, xlim = c(-0.5,0.5), ylim = c(0, 5))
post_int <- extract.samples(m)
plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 40))
plot_contrasts(5, xlim = c(-0.05, 0.15), ylim = c(0, 30))
plot_contrasts(4, xlim = c(-0.1, 0.1), ylim = c(0, 20))
plot_contrasts(3, xlim = c(-0.2, 0.2), ylim = c(0, 15))
plot_contrasts(2, xlim = c(-0.4, 0.4), ylim = c(0, 10))
plot_contrasts(1, xlim = c(-0.5,0.5), ylim = c(0, 5))
post_int <- extract.samples(m)
plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 40))
plot_contrasts(5, xlim = c(-0.15, 0.05), ylim = c(0, 40))
plot_contrasts(4, xlim = c(-0.1, 0.1), ylim = c(0, 20))
plot_contrasts(3, xlim = c(-0.2, 0.2), ylim = c(0, 15))
plot_contrasts(2, xlim = c(-0.4, 0.4), ylim = c(0, 10))
plot_contrasts(1, xlim = c(-0.5,0.5), ylim = c(0, 5))
post_int <- extract.samples(m)
plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 40))
plot_contrasts(5, xlim = c(-0.1, 0.05), ylim = c(0, 40))
plot_contrasts(4, xlim = c(-0.1, 0.1), ylim = c(0, 20))
plot_contrasts(3, xlim = c(-0.2, 0.2), ylim = c(0, 15))
plot_contrasts(2, xlim = c(-0.4, 0.4), ylim = c(0, 10))
plot_contrasts(1, xlim = c(-0.5,0.5), ylim = c(0, 5))
mean(exp(post_int$I[,2,1] - post_int$I[,1,1])) # Intervention, Level
mean(exp(post_int$I[,2,6] - post_int$I[,1,6])) # Intervention, Level
mean(exp(post_int$I[,2,6] - post_int$I[,1,6])) # Intervention, Level
mean(exp(post_int$I[,3,6] - post_int$I[,1,6])) # Intervention, Level
mean(exp(post_int$I[,4,6] - post_int$I[,1,6])) # Intervention, Level
mean(exp(post_int$I[,2,5] - post_int$I[,1,5])) # Intervention, Level
mean(exp(post_int$I[,3,5] - post_int$I[,1,5])) # Intervention, Level
mean(exp(post_int$I[,4,5] - post_int$I[,1,5])) # Intervention, Level
mean(exp(post_int$I[,2,4] - post_int$I[,1,4])) # Intervention, Level
mean(exp(post_int$I[,3,4] - post_int$I[,1,4])) # Intervention, Level
mean(exp(post_int$I[,4,4] - post_int$I[,1,4])) # Intervention, Level
mean(exp(post_int$I[,2,3] - post_int$I[,1,3])) # Intervention, Level
mean(exp(post_int$I[,3,3] - post_int$I[,1,3])) # Intervention, Level
mean(exp(post_int$I[,4,3] - post_int$I[,1,3])) # Intervention, Level
mean(exp(post_int$I[,2,2] - post_int$I[,1,2])) # Intervention, Level
mean(exp(post_int$I[,3,2] - post_int$I[,1,2])) # Intervention, Level
mean(exp(post_int$I[,4,2] - post_int$I[,1,2])) # Intervention, Level
mean(exp(post_int$I[,2,1] - post_int$I[,1,1])) # Intervention, Level
mean(exp(post_int$I[,3,1] - post_int$I[,1,1])) # Intervention, Level
mean(exp(post_int$I[,4,1] - post_int$I[,1,1])) # Intervention, Level
mean(exp(post_int$I[,2,6] - post_int$I[,1,6])) # Intervention, Level
df %>% group_by(intervention) %>% summarise(n = count(gender))
df %>% group_by(intervention) %>% summarise('n' = count(gender))
df %>% group_by(intervention) %>% summarise(count(gender))
df %>% group_by(intervention) %>% count(gender)
df %>% group_by(intervention, level) %>% count(gender)
df %>% group_by(intervention, position) %>% count(gender)
df %>% group_by(position, intervention) %>% count(gender)
as.tibble(predictions)
dens(priormeans, main="Means of Prior Predictions Across All Agents")
pacman::p_load(tidyverse, cowplot)
pacman::p_load(tidyverse, plot_grid())
pacman::p_load(tidyverse, plot_grid, cowplot)
post_int <- extract.samples(m)
p6 <- plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 40))
p5 <- plot_contrasts(5, xlim = c(-0.1, 0.05), ylim = c(0, 40))
p4 <- plot_contrasts(4, xlim = c(-0.1, 0.1), ylim = c(0, 20))
p3 <- plot_contrasts(3, xlim = c(-0.2, 0.2), ylim = c(0, 15))
p2 <- plot_contrasts(2, xlim = c(-0.4, 0.4), ylim = c(0, 10))
p1 <- plot_contrasts(1, xlim = c(-0.5,0.5), ylim = c(0, 5))
plot_grid(p1, p2, p3, p4, p5, p6)
p6 <- plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 40))
p5 <- plot_contrasts(5, xlim = c(-0.1, 0.05), ylim = c(0, 40))
p4 <- plot_contrasts(4, xlim = c(-0.1, 0.1), ylim = c(0, 20))
post_int <- extract.samples(m)
p6 <- plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 40))
p5 <- plot_contrasts(5, xlim = c(-0.1, 0.05), ylim = c(0, 40))
p4 <- plot_contrasts(4, xlim = c(-0.1, 0.1), ylim = c(0, 20))
p3 <- plot_contrasts(3, xlim = c(-0.2, 0.2), ylim = c(0, 15))
p2 <- plot_contrasts(2, xlim = c(-0.4, 0.4), ylim = c(0, 10))
p1 <- plot_contrasts(1, xlim = c(-0.5,0.5), ylim = c(0, 5))
plot_contrasts <- function(level, xlim, ylim){
title <-paste('Intervention Contrast - Level', level)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, level] - PrS[, 1, level] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plt <- plot(NULL, xlim = xlim, ylim = ylim, main = title,ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
return(plt)
}
post_int <- extract.samples(m)
p6 <- plot_contrasts(6, xlim = c(-0.05, 0.15), ylim = c(0, 40))
p5 <- plot_contrasts(5, xlim = c(-0.1, 0.05), ylim = c(0, 40))
p4 <- plot_contrasts(4, xlim = c(-0.1, 0.1), ylim = c(0, 20))
p3 <- plot_contrasts(3, xlim = c(-0.2, 0.2), ylim = c(0, 15))
p2 <- plot_contrasts(2, xlim = c(-0.4, 0.4), ylim = c(0, 10))
p1 <- plot_contrasts(1, xlim = c(-0.5,0.5), ylim = c(0, 5))
plot_grid(p1, p2, p3, p4, p5, p6)
plot_contrasts <- function(level, xlim, ylim){
title <-paste('Intervention Contrast - Level', level)
PrS <- inv_logit(post_int$I)
diff_prob <- sapply(2:4, function(i) PrS[, i, level] - PrS[, 1, level] )
colorlist = c('steelblue1', 'palegreen3', 'khaki')
plt <- plot(NULL, xlim = xlim, ylim = ylim, main = title,ylab = 'Density', xlab = 'Contrast against baseline (Probabilities)')
for(i in 1:3) dens(diff_prob[,i], lwd = 3, col = colorlist[i], add = TRUE)
legend('topright', legend=c("Parental Leave", "Shortlist", "Blinding"), col = colorlist, lty = 1, cex=0.8,box.lwd=2, box.lty = 1, lwd = 3)
abline(v = c(0, 22), lty = 2)
return(plt)
}
predictions <- link(m, post = prior, data = dat)
predictions <- link(m, post = prior, data = dat)
predictions <- link(m, post =
post_int <- extract.samples(m)
predictions <- link(m, post = post_int, data = dat)
post_int <- extract.samples(m)
predictions <- link(m, post = post_int, data = dat)
priormeans <- rowMeans(predictions)
dens(priormeans, main="Means of Posterior Predictions Across All Agents")
post_int <- extract.samples(m)
predictions <- link(m, post = post_int, data = dat)
postmeans <- rowMeans(predictions)
dens(postmeans, main="Means of Posterior Predictions Across All Agents")
library(rethinking)
pacman::p_load(tidyverse, cowplot)
df <- rbind(blinding1, shortlist1, parental1, nointervention1) %>% filter(tick == 59)
dat <- list(
S = as.integer(ifelse(df$gender == 'male', 0 , 1)),
In = as.integer(df$intervention),
L = as.integer(as.factor(df$position))
)
unique(dat$In)
unique(dat$L)
unique(dat$S)
m <- ulam(
alist(S ~ dbern(p),
logit(p) <- I[In,L],
matrix[In, L]:I ~ normal(0, 0.5)
) , data=dat, chains=4, cores = 4, refresh=0)
precis_plot(precis(m, depth = 3))
prior <- extract.prior(m)
predictions <- link(m, post = prior, data = dat)
priormeans <- rowMeans(predictions)
dens(priormeans, main="Means of Prior Predictions Across All Agents")
post_int <- extract.samples(m)
predictions <- link(m, post = post_int, data = dat)
postmeans <- rowMeans(predictions)
dens(postmeans, main="Means of Posterior Predictions Across All Agents")
predicted_gender <- sim(m, dat)
mean_predicted <- round(colMeans(predicted_survival), 0)
predicted_gender <- sim(m, dat)
mean_predicted <- round(colMeans(predicted_gender), 0)
table(dat$S, mean_predicted)
